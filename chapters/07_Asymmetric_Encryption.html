
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Asymmetric Encryption &#8212; Python Security</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/justify.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/analytics_gtag.js"></script>
    <script src="../_static/analytics.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://elc.github.com/python-security/chapters/07_Asymmetric_Encryption.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Input Sanitization" href="08_Input_Sanitization.html" />
    <link rel="prev" title="Symmetric Encryption" href="06_Symmetric_Encryption.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Python Security</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="00_Fundamentals.html">
   Introduction to Security
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Hashes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01_Hash_Introduction.html">
   Introduction to Hash Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_Salt.html">
   Salt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_Pepper.html">
   Pepper
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_Checksum.html">
   Checksum
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_HMAC.html">
   HMAC
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Encryption
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="06_Symmetric_Encryption.html">
   Symmetric Encryption
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Asymmetric Encryption
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Threats
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="08_Input_Sanitization.html">
   Input Sanitization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_Common_Threats.html">
   Common Threats
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="10_JSON_Web_Tokens.html">
   JSON Web Tokens (JWT)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="19_Blockchain.html">
   BlockChain
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Additional Material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="80_Additional_Resources.html">
   Additional Resources
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="91_Bytes.html">
   Appendix: The Bytes Data Type
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="92_Base64.html">
   Appendix: Base64 encoding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="93_URLSafe.html">
   Appendix: URLSafe
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/chapters/07_Asymmetric_Encryption.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ELC/python-security"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        <a class="edit-button" href="https://github.com/ELC/python-security/edit/source/chapters/07_Asymmetric_Encryption.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ELC/python-security/source?urlpath=tree/chapters/07_Asymmetric_Encryption.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/ELC/python-security/blob/source/chapters/07_Asymmetric_Encryption.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#public-key-encryption-digital-signature">
   Public Key Encryption != Digital Signature
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#public-key-encryption-certificate-based-communication">
   Public Key Encryption != Certificate Based Communication
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-usage-for-certificates">
     Other usage for Certificates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#practical-example">
     Practical Example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-certificates-implementation-considerations">
     Using Certificates - Implementation Considerations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#caveats-of-public-key-encryption">
   Caveats of Public Key Encryption
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rsa-encryption">
   RSA Encryption
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-keys">
     Generating Keys
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#encrypting">
     Encrypting
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#decrypting">
     Decrypting
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-unlinked-private-key">
       Using unlinked Private Key
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-unlinked-public-key">
       Using unlinked Public Key
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-original-private-key">
       Using original Private Key
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#signing-message">
     Signing Message
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verifying-signature">
     Verifying Signature
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tampered-message">
       Tampered Message
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tampered-message-and-signature">
       Tampered Message and Signature
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#unliked-public-key">
       Unliked Public Key
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#original-message-signature-and-public-key">
       Original Message, Signature and Public Key
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-pem-files">
   Using PEM Files
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#storing-the-keys-as-pem-files">
     Storing the Keys as PEM Files
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#saving-private-key">
       Saving Private Key
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#saving-public-key">
       Saving Public Key
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loading-pem-files">
     Loading PEM Files
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#wrong-password">
       Wrong Password
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#right-password">
       Right Password
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#encryption-and-decryption-using-pem-files">
     Encryption and Decryption using PEM Files
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Encrypting
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Decrypting
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#digital-signature-using-pem-files">
     Digital Signature using PEM Files
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#signing-a-message">
       Signing a Message
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Verifying Signature
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="asymmetric-encryption">
<h1>Asymmetric Encryption<a class="headerlink" href="#asymmetric-encryption" title="Permalink to this headline">¶</a></h1>
<p>Asymmetric encryption does not have passwords or keys like symmetric but rather it splits the security into a pair of keys, one used to encrypt (usually called Public Key) and another used to decrypt (usually call Private Key). As the name implies one can be shared publicly and the other should be kept secret. This method is also known as <a class="reference external" href="https://en.wikipedia.org/wiki/Public-key_cryptography"><strong>Public-key cryptography</strong></a>.</p>
<p>The keys are sequences of bytes generated together and are mathematically linked, they are also called “Key Pair”. Each party in the communication should have its own key pair and have their Public Keys shared. This means that there is no need for a “secure channel” to exchange keys as in symmetric encryption since the Public key are by design sharable.</p>
<p>This type of encryption is used nowadays in many applications, ranging from the commonplace SSH protocol to the trendy Bitcoin transactions.</p>
<p>A party can generate as many Key Pairs as needed, meaning that, in case of a Private Key being compromised, a new Key Pair can be generated.</p>
<div class="section" id="public-key-encryption-digital-signature">
<h2>Public Key Encryption != Digital Signature<a class="headerlink" href="#public-key-encryption-digital-signature" title="Permalink to this headline">¶</a></h2>
<p>The idea of a <a class="reference external" href="https://en.wikipedia.org/wiki/Digital_signature">Digital Signature</a> is basically reversing Public Key Encryption, that is, instead of encrypting messages that only the holder of the Private Key can decrypt, a message is encrypted with the Private Key so that everyone else can decrypt it using the Public Key. In this case, even though the message is encrypted, the word <strong>signature</strong> is used to represent that it is no secret. The signature itself has the same format as an encrypted message, it is a sequence of bytes.</p>
<p>This scheme does not provide <strong>privacy</strong>, since everyone can decrypt the signature, but it provides <strong>Authentication</strong> (Only the holder of the Private Key could have signed this message) and in some context also legal <strong>Non-Repudiation</strong>. Some countries consider that digitally signed files/messages are subject to non-repudiation.</p>
<p>The Key Pair is exactly the the same as the one used in Public Key Encryption, however the terminology changes to avoid confusion. If Public Key Encryption is an asymmetric analog as symmetric encryption, digital signatures can be thought of as an asymmetric analog of HMACs.</p>
</div>
<div class="section" id="public-key-encryption-certificate-based-communication">
<h2>Public Key Encryption != Certificate Based Communication<a class="headerlink" href="#public-key-encryption-certificate-based-communication" title="Permalink to this headline">¶</a></h2>
<p>One way to implement Public Key Encryption is through <a class="reference external" href="https://en.wikipedia.org/wiki/Public_key_certificate"><strong>Certificates</strong></a>, a certificate is something bigger in scope than the Key Pair because the Key Pair is simply two sequences of bytes whereas the certificate includes not only the public key but also information about the algorithm, versioning, subject and issuer information and so on.</p>
<p>Therefore, a Key Pair is enough to encrypt and decrypt but a certificate has metadata and additional information to establish a <strong>secure channel of communication</strong>. One of the most widely used algorithms for Public Key Encryption is <a class="reference external" href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)"><code class="docutils literal notranslate"><span class="pre">RSA</span></code></a> and the current standard for certificate is <a class="reference external" href="https://en.wikipedia.org/wiki/X.509"><code class="docutils literal notranslate"><span class="pre">X.509</span></code></a> (which uses RSA Public Key Encryption). Certificate based communication is used in most website, the key indicator is the use of TLS, more commonly reflected by the use of HTTPS (instead of HTTP).</p>
<p>Some of the information a certificate contains is:</p>
<ul class="simple">
<li><p>Information about the <strong>identity</strong> (Email, Organization Name, Country, State, <a class="reference external" href="https://en.wikipedia.org/wiki/Certificate_signing_request#Procedure">among others</a>) of who generated the Public Key (the subject).</p></li>
<li><p>A <strong>digital signature</strong> <a class="footnote-reference brackets" href="#id5" id="id1">1</a> that validates the identity information is correct and it corresponds to the subject.</p></li>
</ul>
<p>The drawback of this approach is that nothing impedes an attacker to sign their own certificates, i.e. anyone can claim being anyone else. These are the so-called <a class="reference external" href="https://en.wikipedia.org/wiki/Self-signed_certificate">self-signed certificates</a>. To avoid that, the signature should come from a trusted third party, known as <a class="reference external" href="https://en.wikipedia.org/wiki/Certificate_authority"><strong>Certificate Authority</strong></a>. It needs to be an independent and trusted-by-everyone party that validates the identity of who is generating the Public Key. This is necessary if the subject is unknown or could not be trusted.</p>
<p>When the subject acts as its own CA, generating a self-signed certificate, it triggers warnings in most environments, e.g. most programming libraries will throw validation errors. Web browsers will consider a self-signed certificate to be <strong>insecure</strong>. It is not a matter of security (i.e. the data will be encrypted anyway) but rather a matter of trust, trusting that the received Public Key comes from the intended subject and that there is no other man-in-the-middle.</p>
<p>For debugging and testing, self-signed certificates are usually not a concern, for all other use cases, a certificate signed by a CA should be used.</p>
<p>To get a certificate signed by a CA, one has to submit a <a class="reference external" href="https://en.wikipedia.org/wiki/Certificate_signing_request"><strong>Certificate Signing Request</strong></a>, it normally takes several days and it is usually paid service, they also validate that the identity information corresponds to the one asking for the validation. A CA will not sign certificates to anyone on behalf of anyone else, i.e. I cannot get a CA signing a certificate saying I am Google.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>When logging in a service (e.g. email), one enters a username and a password. It is desired that the password travels encrypted through internet, so that no one can read it but the service provider. To encrypt that, certificate based communication is used, the Public Key is used to encrypt the password and then the service provider can use its private key to read it.</p>
<p>That being said, what happens if the Public Key used does not come from the service provider and instead was injected by an attacker’s Key Pair? They would have a corresponding Private Key with which they can see the password (and then if needed redirect to the real service provider).</p>
<p>That is when Certificate Authorities come in, because the certificate will also include a digital signature saying “This is the public key for this service provider”. Attackers can mimic Public Keys from any subject, however, they cannot bypass the digital signature, because everyone can verify if a digital signature comes from a CA or not.</p>
</div>
<div class="section" id="other-usage-for-certificates">
<h3>Other usage for Certificates<a class="headerlink" href="#other-usage-for-certificates" title="Permalink to this headline">¶</a></h3>
<p>Another usage of certificates is <strong>User Authentication</strong>, in this case one organization can generate specific certificates for each user with all the authentication relevant information. The user can add that certificate to their operating system, and then when making a request only a user id (email, GUID or similar) should be provided.</p>
<p>If the user id matches the information in the certificate and the signature of the certificate is valid (i.e. is was signed by the organization server), the user is consider authenticated and the request is processed.</p>
<p>An example of such authentication mechanism in Flask can be seen in this <a class="reference external" href="https://github.com/ContinuumIO/flask-ssl-authentication">Anaconda Repo</a></p>
</div>
<div class="section" id="practical-example">
<h3>Practical Example<a class="headerlink" href="#practical-example" title="Permalink to this headline">¶</a></h3>
<p>This particular site has <strong>HTTPS</strong> with a certificate signed by <a class="reference external" href="https://www.digicert.com/">DigiCert</a>, one of many Certificate Authorities.</p>
<center>
<img src="../_static/images/certificate_CA_example.png">
</center>
<p>When opened, some details are shown</p>
<center>
<img src="../_static/images/certificate_details.png">
</center>
<p>However, something might draw special attention, it says “<strong>Issued to</strong>: www.github.com” but the site is <a class="reference external" href="https://elc.github.io/"><strong>elc.github.io</strong></a>. If we inspect the details, we can see that the <strong>Issuer</strong> is the CA, the <strong>Subject</strong> is Github and the there is an special field called <strong>Subject Alternative Name</strong>, there one of the DNS Names is <strong>*.github.io</strong> which is compatible which this site URL. Therefore, the browser knows the certificate is from Github, validated by DigiCert and even though the URL is not Github’s it is under one of the registered alternative names.</p>
<center>
<img src="../_static/images/certificate_details_dns.png">
</center></div>
<div class="section" id="using-certificates-implementation-considerations">
<h3>Using Certificates - Implementation Considerations<a class="headerlink" href="#using-certificates-implementation-considerations" title="Permalink to this headline">¶</a></h3>
<p>Some times the process of getting a signed certificate might be troublesome or tedious, fortunately there are shortcuts:</p>
<ul class="simple">
<li><p>Using a hosting service that provides HTTPS out of the box (e.g. Github Pages does it freely)</p></li>
<li><p>Outsourcing the certificate request (e.g. Most cloud providers will do that on our behalf)</p></li>
<li><p>Using hosted services (e.g. Azure Web Apps comes with HTTPS support)</p></li>
</ul>
<p>It is usually useful to work in layers, many times one can have a gateway server (Apache, Nginx or similar) that takes care of the TLS connection (certificate based communications) while the underlying application use it seemlessly. Meaning there is no code change needed on the application side.</p>
<p>The following examples will focus on the Public Key Encryption without the CA signing process for simplicity. To implement a certificate signed by a CA, <a class="reference external" href="https://cryptography.io/en/latest/x509/tutorial">follow the official tutorial</a>. However, <strong>unless being supported by a security expert it is always recommended to trust hosted/managed services instead of doing security from scratch</strong>.</p>
</div>
</div>
<div class="section" id="caveats-of-public-key-encryption">
<h2>Caveats of Public Key Encryption<a class="headerlink" href="#caveats-of-public-key-encryption" title="Permalink to this headline">¶</a></h2>
<p>Asymmetric Encryption is usually much slower than symmetric encryption, that is way in many applications both are used:</p>
<ol class="simple">
<li><p>Both parties exchange their Public Keys.</p></li>
<li><p>The Public Keys are then used to send an encrypted password/key for symmetric encryption.</p></li>
<li><p>All following communication is done encrypted using the symmetric encryption method.</p></li>
</ol>
<p>The particular details of the implementation may vary depending on the specific protocol but generally Asymmetric Encryption is used as the so-called “Secure Channel” to exchange the keys for the symmetric encryption method. Modern HTTPS connections work like this.</p>
</div>
<div class="section" id="rsa-encryption">
<h2>RSA Encryption<a class="headerlink" href="#rsa-encryption" title="Permalink to this headline">¶</a></h2>
<p>RSA is one of the asymmetric encryption algorithms available in the PyCA cryptography library. The particular objects used here are part of the <code class="docutils literal notranslate"><span class="pre">hazmat</span></code> package, <code class="docutils literal notranslate"><span class="pre">hazmat</span></code> stands for “Hazardous Materials” and quoting from their <a class="reference external" href="https://cryptography.io/en/latest/hazmat/primitives/asymmetric/rsa/">site</a>:</p>
<blockquote>
<div><p>This is a “Hazardous Materials” module. You should ONLY use it if you’re 100% absolutely sure that you know what you’re doing because this module is full of land mines, dragons, and dinosaurs with laser guns.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives</span> <span class="kn">import</span> <span class="n">hashes</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.asymmetric</span> <span class="kn">import</span> <span class="n">rsa</span><span class="p">,</span> <span class="n">padding</span>
<span class="kn">from</span> <span class="nn">cryptography.exceptions</span> <span class="kn">import</span> <span class="n">InvalidSignature</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="generating-keys">
<h3>Generating Keys<a class="headerlink" href="#generating-keys" title="Permalink to this headline">¶</a></h3>
<p>The first step is to generate the private key, for that two parameters are needed the <code class="docutils literal notranslate"><span class="pre">public_exponent</span></code> and the <code class="docutils literal notranslate"><span class="pre">key_size</span></code>. The former should be fixed to <code class="docutils literal notranslate"><span class="pre">65537</span></code> whereas the second can be changed and as per modern security standards it should be at least <code class="docutils literal notranslate"><span class="pre">2048</span></code>. Then the Public Key is generated from the private Key object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_key_pair</span><span class="p">():</span>
    <span class="n">key_size</span> <span class="o">=</span> <span class="mi">2048</span>  <span class="c1"># Should be at least 2048</span>

    <span class="n">private_key</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span>
        <span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span>  <span class="c1"># Do not change</span>
        <span class="n">key_size</span><span class="o">=</span><span class="n">key_size</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">public_key</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">private_key</span><span class="p">,</span> <span class="n">public_key</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">private_key</span><span class="p">,</span> <span class="n">public_key</span> <span class="o">=</span> <span class="n">generate_key_pair</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="encrypting">
<h3>Encrypting<a class="headerlink" href="#encrypting" title="Permalink to this headline">¶</a></h3>
<p>For the encryption process only the public key is used, no password is needed. The messages encrypted with this Public Key will only be decryptable with the linked Private Key. Moreover, if other messages are encrypted with different Public Keys, they will not be decryptable with the linked Private Key.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">public_key</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">public_key</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span>
        <span class="n">message</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">.</span><span class="n">OAEP</span><span class="p">(</span>
            <span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()),</span>
            <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span>
            <span class="n">label</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Hello World!&quot;</span>

<span class="n">message_encrypted</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">public_key</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encrypted Text: </span><span class="si">{</span><span class="n">message_encrypted</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Encrypted Text: 5dc6ed8498c91907872929eb3b0f257808daa9417b2d36e351b3af50719c3480b018d8956848195d8ee6a1f38997c5d119430c1348f93bd5f3ea4cefcb7f84a01cfb4069669688540f0bbfdeddf58b4c89164b6a308ea5355f3b1d019c95622f2977d210036b11d1fa70d4e01312a410ad1b316f428eeb491f1746d8407bbee24e63eacf2c6d10a3581b3733caf1f6b9376c9120797c145c639fadf95a31a700e09d5d2e6ee6483282c464a5370e888252dffd0477bd42b0fe2733401507edde0a4b535ce9b2039c3133c49d9ab80ff45dbb9ad7f1794021bab27a020a03c52276f70c6b1432104211756ccd30ff276f675c8e2124dfe6bc9e82fbbdfa22f7e9
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="decrypting">
<h3>Decrypting<a class="headerlink" href="#decrypting" title="Permalink to this headline">¶</a></h3>
<p>Auxiliary Function to decrypt an encrypted message and returning a string message.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">message_encrypted</span><span class="p">,</span> <span class="n">private_key</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">message_decrypted</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span>
            <span class="n">message_encrypted</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">.</span><span class="n">OAEP</span><span class="p">(</span>
                <span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()),</span>
                <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span>
                <span class="n">label</span><span class="o">=</span><span class="kc">None</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Decrypted Message: </span><span class="si">{</span><span class="n">message_decrypted</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Failed to Decrypt&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-unlinked-private-key">
<h4>Using unlinked Private Key<a class="headerlink" href="#using-unlinked-private-key" title="Permalink to this headline">¶</a></h4>
<p>If other <strong>Private Key</strong> different from the one of the original Key Pair is used, the decryption will fail.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">private_key_other</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">generate_key_pair</span><span class="p">()</span>

<span class="n">message_decrypted</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">message_encrypted</span><span class="p">,</span> <span class="n">private_key_other</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">message_decrypted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Failed to Decrypt
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="using-unlinked-public-key">
<h4>Using unlinked Public Key<a class="headerlink" href="#using-unlinked-public-key" title="Permalink to this headline">¶</a></h4>
<p>If other <strong>Public Key</strong> different from the one of the original Key Pair is used, the decryption will fail.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">public_key_other</span> <span class="o">=</span> <span class="n">generate_key_pair</span><span class="p">()</span>

<span class="n">message_encrypted_other</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">public_key_other</span><span class="p">)</span>

<span class="n">message_decrypted</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">message_encrypted_other</span><span class="p">,</span> <span class="n">private_key</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">message_decrypted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Failed to Decrypt
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="using-original-private-key">
<h4>Using original Private Key<a class="headerlink" href="#using-original-private-key" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">message_decrypted</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">message_encrypted</span><span class="p">,</span> <span class="n">private_key</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">message_decrypted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Decrypted Message: b&#39;Hello World!&#39;
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="signing-message">
<h3>Signing Message<a class="headerlink" href="#signing-message" title="Permalink to this headline">¶</a></h3>
<p>To use the Key Pair for Digital Signature, the Private Key is used for encryption. In this case the method is called <code class="docutils literal notranslate"><span class="pre">sign</span></code> and not <code class="docutils literal notranslate"><span class="pre">encrypt</span></code> to have consistent terminology and avoid confusion.</p>
<p>A pair (message, signature) will only be valid if the message, the signature and the public key are the original ones, if any of those gets modified, an error will be thrown.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sign</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">private_key</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">private_key</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span>
        <span class="n">message</span><span class="p">,</span>
        <span class="n">padding</span><span class="o">.</span><span class="n">PSS</span><span class="p">(</span>
            <span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()),</span>
            <span class="n">salt_length</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">PSS</span><span class="o">.</span><span class="n">MAX_LENGTH</span>
        <span class="p">),</span>
        <span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;My website is http://elc.github.io&quot;</span>

<span class="n">signature</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">private_key</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Digital Signature: </span><span class="si">{</span><span class="n">signature</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Digital Signature: 5e9b28e58bb7902013f4021228256067362111aad9059fec1e5424b37eaf55b24fcdd351d175d82261d7f2554e44bef8e0f6fbd9145e8d81e22cf00d26a125d891b8843c58c840b1ca2236c66850c8094ef74b18af786d38aaac71ee51eaaf029fda0797243370777a1ed87625f08e7cc46e5dc40e623de446ebba1ab45182b6547b10163eddff6be9fb5e31135af95a7eb8d60a085b80bda8f0a485b2a24e55875d17578923d371623d45476d64d1ab0bf7c6ad8d29bc8f2cc23c377e150c2d6939bb02a975db43cde80eadc6dfb5befbc82f8c999db17e2b4667be0367dbebb17e26d1d174a5b825e0de70b0db50858e79d34a2fa13f5276bfc7d6f87cd732
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="verifying-signature">
<h3>Verifying Signature<a class="headerlink" href="#verifying-signature" title="Permalink to this headline">¶</a></h3>
<p>This is a helper function to avoid code duplication, it will return a string message depending on whether the message, signature pair is valid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">verify</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">public_key</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">public_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span>
            <span class="n">signature</span><span class="p">,</span>
            <span class="n">message</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">.</span><span class="n">PSS</span><span class="p">(</span>
                <span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()),</span>
                <span class="n">salt_length</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">PSS</span><span class="o">.</span><span class="n">MAX_LENGTH</span>
            <span class="p">),</span>
            <span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;The message has been successfully verified&quot;</span>
    <span class="k">except</span> <span class="n">InvalidSignature</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;The signature, the message or the Public Key is invalid&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="tampered-message">
<h4>Tampered Message<a class="headerlink" href="#tampered-message" title="Permalink to this headline">¶</a></h4>
<p>Possible scenario:</p>
<ol class="simple">
<li><p>An attacker intercepts the message</p></li>
<li><p>They change the message and leave the signature intact</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wrong_message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;My website is http://www.google.com&quot;</span>

<span class="n">verification_message</span> <span class="o">=</span> <span class="n">verify</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">wrong_message</span><span class="p">,</span> <span class="n">public_key</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">verification_message</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The signature, the message or the Public Key is invalid
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tampered-message-and-signature">
<h4>Tampered Message and Signature<a class="headerlink" href="#tampered-message-and-signature" title="Permalink to this headline">¶</a></h4>
<p>Possible scenario:</p>
<ol class="simple">
<li><p>An attacker intercepts the message</p></li>
<li><p>They change the message and generate another signature with their own Private Key</p></li>
</ol>
<p>Note: it would be possible to test leaving the message intact and only changing the signature but that has no practical purpose.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wrong_message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;My website is http://www.google.com&quot;</span>

<span class="n">fake_private_key</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">generate_key_pair</span><span class="p">()</span>
<span class="n">fake_signature</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">wrong_message</span><span class="p">,</span> <span class="n">fake_private_key</span><span class="p">)</span>

<span class="n">verification_message</span> <span class="o">=</span> <span class="n">verify</span><span class="p">(</span><span class="n">fake_signature</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">public_key</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">verification_message</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The signature, the message or the Public Key is invalid
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="unliked-public-key">
<h4>Unliked Public Key<a class="headerlink" href="#unliked-public-key" title="Permalink to this headline">¶</a></h4>
<p>This is an unlikely possibility. Because since Public Keys are shared and public, an attacker has very limited chance to inject a fake public key. It would need to hack the sender and modify their Public Key, if they were able to do such a thing, they would have access the original message anyway.</p>
<p>However, for illustration, if the Public Key is changed, the validation fails as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">public_key_other</span> <span class="o">=</span> <span class="n">generate_key_pair</span><span class="p">()</span>

<span class="n">verification_message</span> <span class="o">=</span> <span class="n">verify</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">public_key_other</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">verification_message</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The signature, the message or the Public Key is invalid
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="original-message-signature-and-public-key">
<h4>Original Message, Signature and Public Key<a class="headerlink" href="#original-message-signature-and-public-key" title="Permalink to this headline">¶</a></h4>
<p>Only when the message, the signature and the public match will the verficiation process succeed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">verification_message</span> <span class="o">=</span> <span class="n">verify</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">public_key</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">verification_message</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The message has been successfully verified
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="using-pem-files">
<h2>Using PEM Files<a class="headerlink" href="#using-pem-files" title="Permalink to this headline">¶</a></h2>
<p>Public Keys, Private Keys and certificates can be saved as files, in that case the <a class="reference external" href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail">Privacy-Enhanced Mail (PEM)</a> format is used. Those are files with suffix <code class="docutils literal notranslate"><span class="pre">.pem</span></code>, <code class="docutils literal notranslate"><span class="pre">.cer</span></code>, <code class="docutils literal notranslate"><span class="pre">.cert</span></code> or <code class="docutils literal notranslate"><span class="pre">.crt</span></code>. They have a characteristic <code class="docutils literal notranslate"><span class="pre">BEGIN</span></code> and <code class="docutils literal notranslate"><span class="pre">END</span></code> line which encloses the content. Since a key pair is a sequence of bytes, base64 is used to convert those to string.</p>
<p>The extension is just to tell the content but the PEM format is a plain-text file, i.e. it can be opened with any text editor.</p>
<p>PEM Files can be used for either Public Key Encryption or Digital Signature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives</span> <span class="kn">import</span> <span class="n">serialization</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="storing-the-keys-as-pem-files">
<h3>Storing the Keys as PEM Files<a class="headerlink" href="#storing-the-keys-as-pem-files" title="Permalink to this headline">¶</a></h3>
<div class="section" id="saving-private-key">
<h4>Saving Private Key<a class="headerlink" href="#saving-private-key" title="Permalink to this headline">¶</a></h4>
<p>The PEM file for the private key <strong>should be kept secret</strong> and never shared, the <strong>whole asymmetric encryption depends on it being hidden</strong>.</p>
<p>Because the <a class="reference external" href="https://en.wikipedia.org/wiki/PKCS_8">Public-Key Cryptography Standards (PKCS) #8 (<code class="docutils literal notranslate"><span class="pre">PKCS8</span></code>)</a> is used as the serialization format, the private key is not stored in raw bytes but rather it is encrypted using symmetric encryption. The symmetric algorithm used is <a class="reference external" href="https://en.wikipedia.org/wiki/PBKDF2">PBKDF2</a>. Therefore, in theory there should not be any risks if the files is leaked, that being said, sharing private key files is against all good practices.</p>
<p><strong>Note: NEVER upload private key files to source control, make sure to add the file to your <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">password</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;my secret&quot;</span>

<span class="n">key_pem_bytes</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">private_bytes</span><span class="p">(</span>
   <span class="n">encoding</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">Encoding</span><span class="o">.</span><span class="n">PEM</span><span class="p">,</span>  <span class="c1"># PEM Format is specified</span>
   <span class="nb">format</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">PrivateFormat</span><span class="o">.</span><span class="n">PKCS8</span><span class="p">,</span>
   <span class="n">encryption_algorithm</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">BestAvailableEncryption</span><span class="p">(</span><span class="n">password</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Filename could be anything</span>
<span class="n">key_pem_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;key.pem&quot;</span><span class="p">)</span>
<span class="n">key_pem_path</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">key_pem_bytes</span><span class="p">);</span>

<span class="n">warning_message</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">     TRUNCATED CONTENT TO REMIND THIS SHOULD NOT BE SHARED</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="n">content</span> <span class="o">=</span> <span class="n">key_pem_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">content</span><span class="p">[:</span><span class="mi">232</span><span class="p">]</span> <span class="o">+</span> <span class="n">warning_message</span> <span class="o">+</span> <span class="n">content</span><span class="p">[</span><span class="mi">1597</span><span class="p">:]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-----BEGIN ENCRYPTED PRIVATE KEY-----
MIIFLTBXBgkqhkiG9w0BBQ0wSjApBgkqhkiG9w0BBQwwHAQIzw+u/N4PHLsCAggA
MAwGCCqGSIb3DQIJBQAwHQYJYIZIAWUDBAEqBBD+ibSMaWLwhQLUHJDjSSjpBIIE
0FSmqPc6mdk4KjmeH6EVFqzQnGZXsOr1W1ToR0Ip3wUQaOsQ5AayBthhBkbRTRIQ

     TRUNCATED CONTENT TO REMIND THIS SHOULD NOT BE SHARED

KkrvAVUglYoGbn3LYyxZNRCFh5niv48mNwF27JA/6earbz8eN7PlRLiG0t1Vb0Ek
vD/Ak4DqmYiMj4c3SS12D0x3ys6DD5gNcSx1jC+GoFfGws1D+3jrcd/UdhIFZ0R7
RQ/N1Bm4UWQs3UxvDJc6E5Ck16WVenJyG6V16/mSL+HbRrGRe855KpeIeyCi7Yvt
EYZsBxiDX7idaQbvlVpdYlsdbYQvxXNAhWrneeXvVniu
-----END ENCRYPTED PRIVATE KEY-----
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="saving-public-key">
<h4>Saving Public Key<a class="headerlink" href="#saving-public-key" title="Permalink to this headline">¶</a></h4>
<p>The PEM file for the public key will be part of a public certificate which will be send to everyone wanting to comunicate with the subject. <strong>There is no risk sharing this</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">public_key</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>

<span class="n">public_pem_bytes</span> <span class="o">=</span> <span class="n">public_key</span><span class="o">.</span><span class="n">public_bytes</span><span class="p">(</span>
   <span class="n">encoding</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">Encoding</span><span class="o">.</span><span class="n">PEM</span><span class="p">,</span>
   <span class="nb">format</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">PublicFormat</span><span class="o">.</span><span class="n">SubjectPublicKeyInfo</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Filename could be anything</span>
<span class="n">public_pem_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;public.pem&quot;</span><span class="p">)</span>
<span class="n">public_pem_path</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">public_pem_bytes</span><span class="p">);</span>

<span class="n">public_key_content</span> <span class="o">=</span> <span class="n">public_pem_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">public_key_content</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5jUwgQHJH+t8LvgN+E/w
oiQ1qF73hRtjab8tEdualDWUGOAHYIEEmgo9sCwFwyq2B/3ANuu0gyfc9uMtw0rc
GhA8nn7CUAcE7gNgTIeFusPspVgqYzE4NVrTWemTxkvInSokHu4i/EzNfFI3X2Xo
1zT9Sw2iKexp0MxAV5mj0HZpTc6VfbdRM8f4hv32RlocQRbFNkdM69bS2TNmr3Ul
G6d3k62pwmuRI7oC1Lg/ISeBVnzFvDVuTON8mQNLqCGqf3i/wqgICbYCTm4VdM6Y
ljGhwhPF1doV6rEp/HwYYQik86ojSm6H1fjXwi7z1ZhGaALAocuE50NZd/T99uEE
YQIDAQAB
-----END PUBLIC KEY-----
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="loading-pem-files">
<h3>Loading PEM Files<a class="headerlink" href="#loading-pem-files" title="Permalink to this headline">¶</a></h3>
<p>PEM files can be loaded directly using the load methods, in the case of the private key, a password should be provided because the <code class="docutils literal notranslate"><span class="pre">PKCS8</span></code> was used to serialized it.</p>
<div class="section" id="wrong-password">
<h4>Wrong Password<a class="headerlink" href="#wrong-password" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">cryptography</span></code> library will throw <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> if the password is incorrect</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">private_pem_bytes</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;key.pem&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
<span class="n">public_pem_bytes</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;public.pem&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>

<span class="n">guess_password</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;my pass&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">private_key_from_pem</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">load_pem_private_key</span><span class="p">(</span>
        <span class="n">private_pem_bytes</span><span class="p">,</span>
        <span class="n">password</span><span class="o">=</span><span class="n">guess_password</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">public_key_from_pem</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">load_pem_public_key</span><span class="p">(</span><span class="n">public_pem_bytes</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Keys Correctly Loaded&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Incorrect Password&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Incorrect Password
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="right-password">
<h4>Right Password<a class="headerlink" href="#right-password" title="Permalink to this headline">¶</a></h4>
<p>If the correct password is used, no errors should be thrown</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">private_pem_bytes</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;key.pem&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
<span class="n">public_pem_bytes</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;public.pem&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">private_key_from_pem</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">load_pem_private_key</span><span class="p">(</span>
        <span class="n">private_pem_bytes</span><span class="p">,</span>
        <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">public_key_from_pem</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">load_pem_public_key</span><span class="p">(</span><span class="n">public_pem_bytes</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Keys Correctly Loaded&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Incorrect Password&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Keys Correctly Loaded
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="encryption-and-decryption-using-pem-files">
<h3>Encryption and Decryption using PEM Files<a class="headerlink" href="#encryption-and-decryption-using-pem-files" title="Permalink to this headline">¶</a></h3>
<p>This are simple examples of encryption and decryption, the functions used are the same as the ones in the above section</p>
<div class="section" id="id2">
<h4>Encrypting<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Hello World!&quot;</span>

<span class="n">public_pem_bytes</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;public.pem&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
<span class="n">public_key_from_pem</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">load_pem_public_key</span><span class="p">(</span><span class="n">public_pem_bytes</span><span class="p">)</span>

<span class="n">message_encrypted</span> <span class="o">=</span> <span class="n">encrypt</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">public_key_from_pem</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encrypted Text: </span><span class="si">{</span><span class="n">message_encrypted</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Encrypted Text: a8f6ab337b5460578e12166e550659d9ea23781e12941b173f8a578f8666476fea56b6cfb984e0c6b5077e31c7f599a7c6e109329f7fd6f09166b045618d12e7296a1e190dc1da801607c8e217cd58812e19c4bab8f17c379bb00438098c455bd6796820b361c2408af55801c881f4385481c9629736b1b43debe42dfe9b3202fc6dd4dd92bacba0e72d9f4fa4956924d30d7b232b38c8b8b534b9f7ac297c328fdfee516f6ad66ff80b28fabc25d1817f1c5ddc35991dfea7c13a244f31f56fe5de8b23081cd94253a038a9f1f9da9a424f54cd4a760244c8168f743a89b08c558b7cf8ffbe5fde441ba86de59183a6ecfd42cf744b4bbe33628a252008c6a4
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h4>Decrypting<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">private_pem_bytes</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;key.pem&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>

<span class="n">private_key_from_pem</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">load_pem_private_key</span><span class="p">(</span>
    <span class="n">private_pem_bytes</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">message_decrypted</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">message_encrypted</span><span class="p">,</span> <span class="n">private_key_from_pem</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">message_decrypted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Decrypted Message: b&#39;Hello World!&#39;
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="digital-signature-using-pem-files">
<h3>Digital Signature using PEM Files<a class="headerlink" href="#digital-signature-using-pem-files" title="Permalink to this headline">¶</a></h3>
<p>This are simple examples of signing and verification, the functions used are the same as the ones in the above section</p>
<div class="section" id="signing-a-message">
<h4>Signing a Message<a class="headerlink" href="#signing-a-message" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;My website is http://elc.github.io&quot;</span>

<span class="n">private_pem_bytes</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;key.pem&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>

<span class="n">private_key_from_pem</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">load_pem_private_key</span><span class="p">(</span>
    <span class="n">private_pem_bytes</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">signature</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">private_key_from_pem</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Digital Signature: </span><span class="si">{</span><span class="n">signature</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Digital Signature: d6e56ccd9f8e419a6a070a1bee74631e011cf346b535ac5bff28c341b09a2e30c4c20e5169aacd92bc53e1e2a49362ce421fee76b79a80dd3aed665b859e9afd3f6f1ae6bbd750990787cc7285c1f5b79aa80adf0c0b40f250dacf30b9ea32382855946ba7e3cd84be12a68f73defdbe80b8791fb0bc37983e9f8976c07d4f22363c655a1eed04a213ead191c850ee44b25e30cde06bea08056094d4c3c5f08c8dcae94cc91f1b39f6a41f5fa071a0dffca21de73f11e6844f4eaba9373acdddb3b5852219df7f951a23c0f78ed7cdccbba7a4c770d42493ec8f945b63f2d11cb4f5814fc778d4ee6ee732415eb9c894fc8755afe2864a84ba08d656e00eedde
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h4>Verifying Signature<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">public_pem_bytes</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;public.pem&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
<span class="n">public_key_from_pem</span> <span class="o">=</span> <span class="n">serialization</span><span class="o">.</span><span class="n">load_pem_public_key</span><span class="p">(</span><span class="n">public_pem_bytes</span><span class="p">)</span>

<span class="n">verification_message</span> <span class="o">=</span> <span class="n">verify</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">public_key_from_pem</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">verification_message</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The message has been successfully verified
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>As opposed to symmetric encryption, asymmetric encryption does not rely on a single key shared across parties. Instead, a Key Pair, consisting of a Public and a Private Key which are mathematically linked, is generated by each party, then the public keys are shared. The public key is used to encrypt the message and only the linked Private Key can decrypt it.</p>
<p>Digital Signatures used the same principle in reverse, the Private Key is used to encrypt and the Public Key to decrypt, this does not provide privacy but guarantees that a message has not been tampered with.</p>
<p>For serialization and persistance Key Pairs can be stored in disk using the PEM format, for security reasons the Private Key PEM file is saved encrypted with symmetric encryption and hence requires a passphrase.</p>
<p>Asymmetric Encryption is mostly used as part of a bigger technology called Certificates which provides not only access to the Public Key needed to encrypt the message but also information about the subject, the issuer and a digital signature (among other fields). Certificates could be self-signed (insecure or only suitable for testing) or signed by a trusted third party called Certificate Authority.</p>
<p>The most widely used algorithm for Public Key Encryption and Digital Signatures is RSA and for Certificate Based Comunication is X.509</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Digital signature is the topic of the next chapter</p>
</dd>
</dl>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ELC/python-security",
            ref: "source",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="06_Symmetric_Encryption.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Symmetric Encryption</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="08_Input_Sanitization.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Input Sanitization</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Ezequiel Leonardo Castaño<br/>
        
            &copy; Copyright 2021, Ezequiel Leonardo Castaño.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>